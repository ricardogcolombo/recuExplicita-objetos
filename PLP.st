Object subclass: #Regex	instanceVariableNames: 'expresion'	classVariableNames: ''	poolDictionaries: ''	category: 'PLP'!!Regex commentStamp: '<historical>' prior: 0!Please comment me using the following template inspired by Class Responsibility Collaborator (CRC) design:For the Class part:  State a one line summary. For example, "I represent a paragraph of text".For the Responsibility part: Three sentences about my main responsibilities - what I do, what I know.For the Collaborators Part: State my main collaborators and one line about how I interact with them. Public API and Key Messages- message one   - message two - (for bonus points) how to create instances.   One simple example is simply gorgeous. Internal Representation and Key Implementation Points.    Instance Variables	expresion:		<Object>    Implementation Points!!Regex methodsFor: 'copying' stamp: 'alanLebe 7/12/2018 07:32'!, aRegex	|subExp|	subExp := (Concatenate new) initializeWithSubExpresionLeft: self andSubExpresionRight: aRegex.	^ subExp.! !!Regex methodsFor: 'evaluating' stamp: 'alanLebe 7/12/2018 07:32'!isNotNil	^ (self = nil) not.! !!Regex methodsFor: 'evaluating' stamp: 'alanLebe 7/13/2018 01:32'!length: aBlock	|min max|	min := self minLenght.	max := self maxLenght.	^ aBlock value: min value: max.! !!Regex methodsFor: 'as yet unclassified' stamp: 'alanLebe 7/12/2018 07:31'!star	|subExp|	subExp := (Star new) initializeWith: self.	^ subExp.! !!Regex methodsFor: 'logical operations' stamp: 'alanLebe 7/12/2018 07:32'!| aRegex	|subExp|	subExp := (Union new) initializeWithSubExpresionLeft: self andSubExpresionRight: aRegex.	^ subExp.! !"-- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- "!Regex class	instanceVariableNames: ''!!Regex class methodsFor: 'requirements' stamp: 'alanLebe 7/16/2018 02:43'!doesNotUnderstand: aMessage	^ (Symbolo new) initializeWith: (aMessage selector at: 1).! !!Regex class methodsFor: 'requirements' stamp: 'alanLebe 7/16/2018 18:12'!empty	^Empty new.! !Regex subclass: #Concatenate	instanceVariableNames: 'leftSubExpresion rightSubExpresion'	classVariableNames: ''	poolDictionaries: ''	category: 'PLP'!!Concatenate commentStamp: '<historical>' prior: 0!Please comment me using the following template inspired by Class Responsibility Collaborator (CRC) design:For the Class part:  State a one line summary. For example, "I represent a paragraph of text".For the Responsibility part: Three sentences about my main responsibilities - what I do, what I know.For the Collaborators Part: State my main collaborators and one line about how I interact with them. Public API and Key Messages- message one   - message two - (for bonus points) how to create instances.   One simple example is simply gorgeous. Internal Representation and Key Implementation Points.    Instance Variables	subExpresion:		<Object>    Implementation Points!!Concatenate methodsFor: 'initialization' stamp: 'alanLebe 7/13/2018 01:26'!minLenght	^ leftSubExpresion minLenght + rightSubExpresion minLenght.! !!Concatenate methodsFor: 'initialization' stamp: 'alanLebe 7/1/2018 22:52'!prefix	^ leftSubExpresion.! !!Concatenate methodsFor: 'initialization' stamp: 'alanLebe 7/1/2018 22:52'!suffix	^ rightSubExpresion.! !!Concatenate methodsFor: 'initialization' stamp: 'alanLebe 7/13/2018 01:26'!maxLenght	^ leftSubExpresion maxLenght + rightSubExpresion maxLenght.! !!Concatenate methodsFor: 'initialization' stamp: 'alanLebe 7/16/2018 18:01'!match: aString	|matches|	matches := false.	matches := matches or: ( (leftSubExpresion match: '') and: (rightSubExpresion match: aString) ).	matches := matches or: ( (leftSubExpresion match: aString) and: (rightSubExpresion match: '') ).	1 to: aString size - 1 do: [ :i |		matches := matches or: 		( (leftSubExpresion match: (aString copyFrom: 1 to: i))			and: 			(rightSubExpresion match: (aString copyFrom: i + 1 to: aString size)) )			].			^ matches.		! !!Concatenate methodsFor: 'initialization' stamp: 'alanLebe 7/2/2018 01:24'!printString	^ (leftSubExpresion printString) , (rightSubExpresion printString).! !!Concatenate methodsFor: 'initialization' stamp: 'alanLebe 7/2/2018 01:03'!hasStar	^ (leftSubExpresion hasStar) or: (rightSubExpresion hasStar).! !!Concatenate methodsFor: 'initialization' stamp: 'alanLebe 6/30/2018 21:27'!initializeWithSubExpresionLeft: aRegex andSubExpresionRight: anotherRegex.	leftSubExpresion := aRegex.	rightSubExpresion := anotherRegex.! !Regex subclass: #Empty	instanceVariableNames: ''	classVariableNames: ''	poolDictionaries: ''	category: 'PLP'!!Empty commentStamp: '<historical>' prior: 0!Please comment me using the following template inspired by Class Responsibility Collaborator (CRC) design:For the Class part:  State a one line summary. For example, "I represent a paragraph of text".For the Responsibility part: Three sentences about my main responsibilities - what I do, what I know.For the Collaborators Part: State my main collaborators and one line about how I interact with them. Public API and Key Messages- message one   - message two - (for bonus points) how to create instances.   One simple example is simply gorgeous. Internal Representation and Key Implementation Points.    Implementation Points!!Empty methodsFor: 'evaluating' stamp: 'alanLebe 7/16/2018 00:43'!match: aString	^ aString = ''.! !!Empty methodsFor: 'testing' stamp: 'alanLebe 7/13/2018 01:20'!maxLenght	^ 0.! !!Empty methodsFor: 'testing' stamp: 'alanLebe 7/2/2018 01:10'!value	^ self.! !!Empty methodsFor: 'testing' stamp: 'alanLebe 7/2/2018 01:13'!printString	^ 'empty'.! !!Empty methodsFor: 'testing' stamp: 'alanLebe 7/2/2018 01:10'!hasStar	^ false.! !!Empty methodsFor: 'testing' stamp: 'alanLebe 7/13/2018 01:20'!minLenght	^ 0.! !Regex subclass: #Star	instanceVariableNames: 'subExpresion'	classVariableNames: ''	poolDictionaries: ''	category: 'PLP'!!Star commentStamp: '<historical>' prior: 0!Please comment me using the following template inspired by Class Responsibility Collaborator (CRC) design:For the Class part:  State a one line summary. For example, "I represent a paragraph of text".For the Responsibility part: Three sentences about my main responsibilities - what I do, what I know.For the Collaborators Part: State my main collaborators and one line about how I interact with them. Public API and Key Messages- message one   - message two - (for bonus points) how to create instances.   One simple example is simply gorgeous. Internal Representation and Key Implementation Points.    Implementation Points!!Star methodsFor: 'initialization' stamp: 'alanLebe 7/13/2018 01:31'!maxLenght	^ Float infinity.	! !!Star methodsFor: 'initialization' stamp: 'alanLebe 7/16/2018 18:02'!match: aString	|matches|	matches := false.	matches := matches or: (aString = '').	matches := matches or: (subExpresion match: aString). 	1 to: aString size - 1 do: [ :i |		matches := matches or: 		( (subExpresion match: (aString copyFrom: 1 to: i))			and: 			(self match: (aString copyFrom: i + 1 to: aString size)) )			].			^ matches.! !!Star methodsFor: 'initialization' stamp: 'alanLebe 6/30/2018 20:00'!initializeWith: anExpresion	subExpresion := anExpresion.! !!Star methodsFor: 'initialization' stamp: 'alanLebe 6/30/2018 21:49'!value	^ subExpresion.! !!Star methodsFor: 'initialization' stamp: 'alanLebe 7/2/2018 01:22'!printString	^ '(' , (subExpresion printString) , ')*'.! !!Star methodsFor: 'initialization' stamp: 'alanLebe 7/2/2018 01:08'!hasStar	^ true.! !!Star methodsFor: 'initialization' stamp: 'alanLebe 7/13/2018 01:21'!minLenght	^ 0.! !Regex subclass: #Symbolo	instanceVariableNames: 'symbol'	classVariableNames: ''	poolDictionaries: ''	category: 'PLP'!!Symbolo commentStamp: '<historical>' prior: 0!Please comment me using the following template inspired by Class Responsibility Collaborator (CRC) design:For the Class part:  State a one line summary. For example, "I represent a paragraph of text".For the Responsibility part: Three sentences about my main responsibilities - what I do, what I know.For the Collaborators Part: State my main collaborators and one line about how I interact with them. Public API and Key Messages- message one   - message two - (for bonus points) how to create instances.   One simple example is simply gorgeous. Internal Representation and Key Implementation Points.    Implementation Points!!Symbolo methodsFor: 'instance creation' stamp: 'alanLebe 7/13/2018 01:20'!maxLenght	^ 1.! !!Symbolo methodsFor: 'instance creation' stamp: 'alanLebe 7/16/2018 18:07'!match: aString	^ aString = symbol asString.! !!Symbolo methodsFor: 'instance creation' stamp: 'alanLebe 7/1/2018 22:22'!initializeWith: aSymbol	symbol := aSymbol.! !!Symbolo methodsFor: 'instance creation' stamp: 'alanLebe 6/30/2018 21:48'!value	^ symbol.! !!Symbolo methodsFor: 'instance creation' stamp: 'alanLebe 7/2/2018 01:19'!printString	^ symbol asString.! !!Symbolo methodsFor: 'instance creation' stamp: 'alanLebe 7/2/2018 01:08'!hasStar	^ false.! !!Symbolo methodsFor: 'instance creation' stamp: 'alanLebe 7/13/2018 01:20'!minLenght	^ 1.! !TestCase subclass: #TestEj1	instanceVariableNames: ''	classVariableNames: ''	poolDictionaries: ''	category: 'PLP'!!TestEj1 methodsFor: 'tests' stamp: 'EdgardoZoppi 6/6/2018 23:24'!test1_1_regex	|e a b aaa a_b ab|		e := Regex empty.	a := Regex a.	b := Regex b.	aaa := a star.	a_b := a | b.	ab := a , b.		self assert: e isNotNil.	self assert: a isNotNil.	self assert: b isNotNil.	self assert: a_b isNotNil.	self assert: aaa isNotNil.	self assert: ab isNotNil.		self assert: a value equals: $a.	self assert: b value equals: $b.	self assert: aaa value equals: a.	self assert: a_b option1 equals: a.	self assert: a_b option2 equals: b.	self assert: ab prefix equals: a.	self assert: ab suffix equals: b.! !TestCase subclass: #TestEj2	instanceVariableNames: ''	classVariableNames: ''	poolDictionaries: ''	category: 'PLP'!!TestEj2 methodsFor: 'tests' stamp: 'EdgardoZoppi 6/7/2018 21:53'!test2_2_printString	|e a b c aaa abc b_c aaab_c|		e := Regex empty.	a := Regex a.	b := Regex b.	c := Regex c.	aaa := a star.	abc := a , b , c.	b_c := b | c.	aaab_c := aaa , b_c.		self assert: e printString equals: 'empty'.	self assert: a printString equals: 'a'.	self assert: abc printString equals: 'abc'.	self assert: b_c printString equals: '(b|c)'.	self assert: aaa printString equals: '(a)*'.	self assert: aaab_c printString equals: '(a)*(b|c)'.! !!TestEj2 methodsFor: 'tests' stamp: 'EdgardoZoppi 6/6/2018 03:48'!test2_1_hasStar	|e a b c aaa b_c aaab_c|		e := Regex empty.	a := Regex a.	b := Regex b.	c := Regex c.	aaa := a star.	b_c := b | c.	aaab_c := aaa , b_c.		self assert: aaa hasStar.	self assert: aaab_c hasStar.	self assert: e hasStar not.	self assert: a hasStar not.	self assert: b_c hasStar not.! !TestCase subclass: #TestEj3	instanceVariableNames: ''	classVariableNames: ''	poolDictionaries: ''	category: 'PLP'!!TestEj3 methodsFor: 'tests' stamp: 'EdgardoZoppi 6/7/2018 00:10'!test3_1_minLength	|e a b c aaa b_c aaab_c min|		e := Regex empty.	a := Regex a.	b := Regex b.	c := Regex c.	aaa := a star.	b_c := b | c.	aaab_c := aaa , b_c.	min := [:x :y | x min: y].		self assert: (aaa length: min) equals: 0.	self assert: (aaab_c length: min) equals: 1.	self assert: (e length: min) equals: 0.	self assert: (a length: min) equals: 1.	self assert: (b_c length: min) equals: 1.! !!TestEj3 methodsFor: 'tests' stamp: 'EdgardoZoppi 6/7/2018 00:09'!test3_2_maxLength	|e a b c aaa b_c aaab_c max|		e := Regex empty.	a := Regex a.	b := Regex b.	c := Regex c.	aaa := a star.	b_c := b | c.	aaab_c := aaa , b_c.	max := [:x :y | x max: y].		self assert: (aaa length: max) isInfinite.	self assert: (aaab_c length: max) isInfinite.	self assert: (e length: max) equals: 0.	self assert: (a length: max) equals: 1.	self assert: (b_c length: max) equals: 1.! !TestCase subclass: #TestEj4	instanceVariableNames: ''	classVariableNames: ''	poolDictionaries: ''	category: 'PLP'!!TestEj4 methodsFor: 'tests' stamp: 'EdgardoZoppi 6/7/2018 00:07'!test4_4_or	|a b a_b|		a := Regex a.	b := Regex b.	a_b := a | b.		self assert: (a_b match: 'a').	self assert: (a_b match: 'b').	self assert: (a_b match: '') not.	self assert: (a_b match: 'ab') not.	self assert: (a_b match: 'ba') not.! !!TestEj4 methodsFor: 'tests' stamp: 'EdgardoZoppi 6/7/2018 00:08'!test4_5_star	|a aaa|		a := Regex a.	aaa := a star.		self assert: (aaa match: '').	self assert: (aaa match: 'a').	self assert: (aaa match: 'aa').	self assert: (aaa match: ('a' repeat: (Random new nextInt: 10))).	self assert: (aaa match: 'b') not.	self assert: (aaa match: 'ab') not.	self assert: (aaa match: 'aab') not.! !!TestEj4 methodsFor: 'tests' stamp: 'EdgardoZoppi 6/7/2018 00:06'!test4_2_char	|a b|		a := Regex a.	b := Regex b.		self assert: (a match: 'a').	self assert: (a match: '') not.	self assert: (a match: 'b') not.	self assert: (a match: 'ab') not.		self assert: (b match: 'b').	self assert: (b match: '') not.	self assert: (b match: 'a') not.	self assert: (b match: 'ba') not.! !!TestEj4 methodsFor: 'tests' stamp: 'EdgardoZoppi 6/11/2018 22:32'!test4_6_match	|a b c b_c aaa aaab_c bbbb|		a := Regex a.	b := Regex b.	c := Regex c.	aaa := a star.	b_c := b | c.	aaab_c := aaa , b_c.	bbbb := b star , b.		self assert: (aaab_c match: 'b').	self assert: (aaab_c match: 'c').	self assert: (aaab_c match: 'ab').	self assert: (aaab_c match: 'ac').	self assert: (aaab_c match: 'aab').	self assert: (aaab_c match: 'aaac').	self assert: (bbbb match: 'b').	self assert: (bbbb match: 'bb').	self assert: (bbbb match: 'bbb').	self assert: (bbbb match: '') not.	self assert: (aaab_c match: '') not.	self assert: (aaab_c match: 'a') not.	self assert: (aaab_c match: 'aa') not.	self assert: (aaab_c match: 'aaa') not.	self assert: (aaab_c match: 'ba') not.	self assert: (aaab_c match: 'ca') not.! !!TestEj4 methodsFor: 'tests' stamp: 'EdgardoZoppi 6/7/2018 00:06'!test4_1_empty	|e|		e := Regex empty.		self assert: (e match: '').	self assert: (e match: 'a') not.! !!TestEj4 methodsFor: 'tests' stamp: 'EdgardoZoppi 6/7/2018 00:06'!test4_3_concat	|a b ab|		a := Regex a.	b := Regex b.	ab := a , b.		self assert: (ab match: 'ab').	self assert: (ab match: '') not.	self assert: (ab match: 'a') not.	self assert: (ab match: 'aba') not.! !!TestEj4 methodsFor: 'tests' stamp: 'alanLebe 7/16/2018 18:09'!test4_7_matchExhaustive	|a b aStar aStarStar complex subComplex other|		a := Regex a.	b := Regex b.		aStar := a star.	aStarStar := aStar star.	other := (b | aStar).	subComplex := other star.	aStarStar printString.	complex := aStarStar , subComplex.		self assert: (complex match: 'b').   self assert: (complex match: '').	   self assert: (complex match: 'aaaaaaaaaa').   self assert: (complex match: 'ab').   self assert: (subComplex match: 'bb').   self assert: (complex match: 'bbbabbbab').   self assert: (complex match: 'bbbabbba').   ! !Regex subclass: #Union	instanceVariableNames: 'leftSubExpresion rightSubExpresion'	classVariableNames: ''	poolDictionaries: ''	category: 'PLP'!!Union commentStamp: '<historical>' prior: 0!Please comment me using the following template inspired by Class Responsibility Collaborator (CRC) design:For the Class part:  State a one line summary. For example, "I represent a paragraph of text".For the Responsibility part: Three sentences about my main responsibilities - what I do, what I know.For the Collaborators Part: State my main collaborators and one line about how I interact with them. Public API and Key Messages- message one   - message two - (for bonus points) how to create instances.   One simple example is simply gorgeous. Internal Representation and Key Implementation Points.    Instance Variables	subExpresion:		<Object>    Implementation Points!!Union methodsFor: 'initialization' stamp: 'alanLebe 7/13/2018 01:28'!minLenght	^ leftSubExpresion minLenght min: rightSubExpresion minLenght.! !!Union methodsFor: 'initialization' stamp: 'alanLebe 6/30/2018 21:51'!option1	^ leftSubExpresion.	! !!Union methodsFor: 'initialization' stamp: 'alanLebe 7/13/2018 01:28'!maxLenght	^ leftSubExpresion maxLenght max: rightSubExpresion maxLenght.! !!Union methodsFor: 'initialization' stamp: 'alanLebe 6/30/2018 21:51'!option2	^ rightSubExpresion.	! !!Union methodsFor: 'initialization' stamp: 'alanLebe 7/16/2018 17:21'!match: aString	^ (leftSubExpresion match: aString) or: (rightSubExpresion match: aString).! !!Union methodsFor: 'initialization' stamp: 'alanLebe 7/2/2018 01:24'!printString	^ '(' , (leftSubExpresion printString) , '|' , (rightSubExpresion printString) , ')'.	! !!Union methodsFor: 'initialization' stamp: 'alanLebe 7/2/2018 01:03'!hasStar	^ (leftSubExpresion hasStar) or: (rightSubExpresion hasStar).! !!Union methodsFor: 'initialization' stamp: 'alanLebe 6/30/2018 21:51'!initializeWithSubExpresionLeft: aRegex andSubExpresionRight: anotherRegex	leftSubExpresion := aRegex.	rightSubExpresion := anotherRegex.! !